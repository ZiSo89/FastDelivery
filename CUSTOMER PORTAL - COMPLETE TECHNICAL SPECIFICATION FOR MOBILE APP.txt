GitHub Copilot: ÎšÎ±Î»Î·ÏƒÏ€Î­ÏÎ± Î£Î¬ÎºÎ·! Î˜Î± Î±Î½Î±Î»ÏÏƒÏ‰ ÏŒÎ»Î¿ Ï„Î¿ project ÎºÎ±Î¹ Î¸Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®ÏƒÏ‰ Î­Î½Î± Ï€Î»Î®ÏÎµÏ‚ documentation Î³Î¹Î± Ï„Î¿ AI ÏÏƒÏ„Îµ Î½Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î½Î±Ï€Î±ÏÎ¬Î³ÎµÎ¹ Ï„Î¿ customer app ÏƒÎµ React Native. Î˜Î± ÎµÏƒÏ„Î¹Î¬ÏƒÏ‰ ÏƒÏ„Î¿ Customer Portal.

## ğŸ“± CUSTOMER PORTAL - COMPLETE TECHNICAL SPECIFICATION FOR MOBILE APP

### âœ… CURRENT STATUS (Updated: 25/11/2025)
**Completed Features:**
- [x] Authentication (Login, Register, Guest Checkout)
- [x] Store List & Map View (Toggle implemented)
- [x] Create Order (Text & Voice Recording implemented)
- [x] Order History (Auto-refresh fixed)
- [x] Real-time Order Tracking (Socket.io integration fixed)
- [x] Profile Screen (Basic implementation)
- [x] Design System (Cyan theme applied)

**Pending / To Do:**
- [ ] Push Notifications (Not yet configured)
- [ ] Deep Linking (track/:orderNumber)
- [ ] Google Places Autocomplete (Currently using Expo Location Reverse Geocoding)
- [ ] Live Driver Tracking on Map (Socket events for location not yet fully implemented)

---

### ğŸ”‘ AUTHENTICATION FLOW [COMPLETED]

**Entry Points:**
1. **Login** (`/login`) - Shared for all users
2. **Customer Register** (`/customer/register`) - Registration with Google Places
3. **Guest Checkout** - No registration required

**Auth Context (`src/context/AuthContext.js`):**
```javascript
// Stores in localStorage:
- token: JWT token
- user: {_id, name, email, phone, address, role: 'customer'}
- refreshToken: for token renewal

// Key functions:
- login(email, password)
- register(userData) 
- logout()
- isAuthenticated()
```

### ğŸ“ CUSTOMER APP SCREENS & ROUTES

**Main Navigation Structure:**
```
/ (Root)
â”œâ”€â”€ /login                    â†’ Login.js
â”œâ”€â”€ /register                 â†’ RegisterSelection.js
â”œâ”€â”€ /customer/register        â†’ pages/customer/Register.js
â”œâ”€â”€ /customer                 â†’ CustomerPortal.js (Main Container)
â”‚   â”œâ”€â”€ /customer/home        â†’ CustomerHome.js (Store List/Map)
â”‚   â”œâ”€â”€ /customer/new-order   â†’ NewOrder.js (Create Order)
â”‚   â”œâ”€â”€ /customer/orders      â†’ CustomerOrders.js (Order History)
â”‚   â”œâ”€â”€ /customer/profile     â†’ CustomerProfile.js
â”‚   â””â”€â”€ /customer/order/:id   â†’ OrderStatus.js (Track Order)
â””â”€â”€ /track/:orderNumber       â†’ TrackOrder.js (Guest Tracking)
```

### ğŸ¨ DESIGN SYSTEM (CRITICAL)

**Colors:**
```css
--primary: #00c2e8;        /* Cyan - Main brand color */
--primary-hover: #00a8cc;  /* Darker cyan for hover */
--background: #f8f9fa;     /* Light grey background */
--card-bg: #ffffff;        /* White cards */
--text-primary: #2c3e50;  /* Dark grey text */
--text-secondary: #6c757d; /* Light grey text */
--border: #e0e0e0;        /* Light border */
--success: #27ae60;       /* Green for success */
--danger: #e74c3c;        /* Red for errors */
```

**Typography:**
```css
font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
--font-size-base: 16px;
--font-size-small: 14px;
--font-size-large: 18px;
--font-size-h1: 28px;
--font-size-h2: 24px;
```

**Components Styling:**
```css
/* Buttons */
.btn-primary-app {
  background: #00c2e8;
  border: none;
  border-radius: 8px;
  padding: 12px 24px;
  font-weight: 500;
  transition: all 0.3s;
}

/* Cards */
.store-card, .order-card {
  background: white;
  border-radius: 16px;
  padding: 20px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  border: 1px solid #f0f0f0;
}

/* Input Fields */
.form-control-app {
  background: #f9f9f9;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  padding: 12px 16px;
  font-size: 16px;
}
```

### ğŸ“± SCREEN-BY-SCREEN BREAKDOWN

#### 1. **CustomerHome.js** - Store Selection
**Purpose:** Display stores list/map, search, select store for ordering

**State Management:**
```javascript
const [stores, setStores] = useState([]);
const [viewMode, setViewMode] = useState('list'); // 'list' or 'map'
const [userLocation, setUserLocation] = useState(null);
const [searchTerm, setSearchTerm] = useState('');
```

**API Calls:**
```javascript
// Get stores near user
GET /api/v1/stores/nearby?lat={lat}&lng={lng}&radius=5000
Response: [{
  _id, name, address, location: {coordinates: [lng, lat]},
  cuisine, minimumOrder, deliveryTime, image, isOpen
}]

// Get user location
navigator.geolocation.getCurrentPosition()
```

**Map Integration:**
```javascript
// Uses @react-google-maps/api
<GoogleMap center={{lat, lng}} zoom={14}>
  <Marker position={userLocation} icon="blue-dot" />
  {stores.map(store => 
    <Marker position={{lat: store.location.coordinates[1], lng: store.location.coordinates[0]}}
            icon="red-pin" onClick={() => navigateToOrder(store)} />
  )}
</GoogleMap>
```

#### 2. **NewOrder.js** - Create Order
**Purpose:** Submit text/voice order to selected store

**State:**
```javascript
const [orderType, setOrderType] = useState('text');
const [orderText, setOrderText] = useState('');
const [isRecording, setIsRecording] = useState(false);
const [audioBlob, setAudioBlob] = useState(null);
const [customerInfo, setCustomerInfo] = useState({
  name: user?.name || '',
  phone: user?.phone || '',
  address: user?.address || '',
  location: user?.location || null
});
```

**Voice Recording:** [COMPLETED]
```javascript
// Uses expo-av
import { Audio } from 'expo-av';
// Recording logic implemented in OrderScreen.js
// Uploads via FormData to POST /api/v1/orders
```

**Order Submission:**
```javascript
POST /api/v1/orders
Body: {
  storeId, 
  orderType: 'text'|'voice',
  orderText,
  voiceMessageUrl,
  customerDetails: {name, phone, address, location},
  isGuest: !user
}
Response: {orderNumber: 'ORD-20251125-0001', _id}
```

#### 3. **OrderStatus.js** - Live Order Tracking
**Purpose:** Real-time order status with map tracking

**Socket.IO Events:**
```javascript
// Connect with orderId
socket.emit('join-order', orderId);

// Listen for updates
socket.on('order-update', (order) => {
  setOrder(order);
  // Update UI based on status
});

// Status progression
const statusSteps = [
  'new', 'accepted', 'pricing', 'customer_confirmed',
  'pending_admin', 'assigned', 'preparing', 
  'ready', 'on_the_way', 'delivered'
];
```

**Map Display (Future Live Tracking):**
```javascript
// When status === 'on_the_way'
<GoogleMap>
  <Marker position={storeLocation} icon="store" />
  <Marker position={customerLocation} icon="home" />
  <Marker position={driverLocation} icon="delivery-bike" /> // Live updates
  <DirectionsRenderer route={route} />
</GoogleMap>
```

#### 4. **CustomerOrders.js** - Order History
**API:**
```javascript
GET /api/v1/orders/customer/my-orders
Headers: { Authorization: `Bearer ${token}` }
Response: [{
  _id, orderNumber, storeName, totalCost,
  status, createdAt, items
}]
```

#### 5. **Register.js** - Customer Registration [PARTIALLY COMPLETED]
**Address Selection:**
- Currently uses `expo-location` for GPS positioning and Reverse Geocoding.
- **Pending:** Google Places Autocomplete for manual search.

### ğŸ”Œ API SERVICE CONFIGURATION

**Base Configuration (`src/services/api.js`):**
```javascript
const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api/v1';

// Axios interceptor for auth
axios.interceptors.request.use((config) => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});
```

**Key Endpoints for Customer:**
```javascript
// Auth
POST /auth/login
POST /auth/customer/register
POST /auth/refresh-token

// Orders
POST /orders (create)
GET /orders/customer/my-orders
GET /orders/:id
GET /orders/:orderNumber/status
PUT /orders/:id/confirm-price
PUT /orders/:id/cancel

// Stores
GET /stores/nearby
GET /stores/:id

// Profile
GET /profile
PUT /profile/update
```

### ğŸ”” SOCKET.IO REAL-TIME UPDATES

**Connection (`src/services/socket.js`):**
```javascript
const socket = io(SOCKET_URL, {
  transports: ['websocket'],
  auth: { token: localStorage.getItem('token') }
});

// Auto-reconnect
socket.on('connect', () => {
  const user = JSON.parse(localStorage.getItem('user'));
  socket.emit('register', { userId: user._id, role: 'customer' });
});
```

**Events Customer Listens To:**
```javascript
socket.on('order-update', (data) => {
  // Update order status in UI
  // Show notification
  // Play sound if status changed
});

socket.on('price-set', (data) => {
  // Show price confirmation modal
});

socket.on('driver-location', (location) => {
  // Update driver marker on map (future)
});
```

### ğŸ¯ MOBILE APP REQUIREMENTS

**React Native Packages Needed:**
```json
{
  "@react-navigation/native": "^7.x",
  "@react-navigation/native-stack": "^7.x",
  "@react-navigation/bottom-tabs": "^7.x",
  "react-native-maps": "1.20.1",
  "react-native-google-places-autocomplete": "^2.6.1",
  "expo-location": "~19.0.7",
  "socket.io-client": "^4.8.1",
  "axios": "^1.13.2",
  "expo-secure-store": "~15.0.7",
  "expo-av": "~16.0.7",
  "react-native-vector-icons": "^10.3.0"
  // Pending: Push Notifications package
}
```

**Platform-Specific Considerations:**
1. **Storage:** Use AsyncStorage instead of localStorage
2. **Navigation:** Use React Navigation instead of React Router
3. **Maps:** Use react-native-maps with Google Maps
4. **Permissions:** Request location, microphone, notifications
5. **Push Notifications:** Use FCM for Android, APNs for iOS
6. **Deep Linking:** Handle track/:orderNumber URLs

### ğŸ“Š STATE MANAGEMENT PATTERN

**Context Pattern Used:**
```javascript
// AuthContext for user/token
// NotificationContext for toasts/alerts
// No Redux - all state local or in context

// Component state pattern:
const [loading, setLoading] = useState(false);
const [error, setError] = useState(null);
const [data, setData] = useState(null);

// API call pattern:
const fetchData = async () => {
  setLoading(true);
  try {
    const response = await api.get('/endpoint');
    setData(response.data);
  } catch (err) {
    setError(err.message);
  } finally {
    setLoading(false);
  }
};
```

### ğŸŒ INTERNATIONALIZATION

**All text in Greek:**
```javascript
const strings = {
  home: 'Î‘ÏÏ‡Î¹ÎºÎ®',
  orders: 'Î Î±ÏÎ±Î³Î³ÎµÎ»Î¯ÎµÏ‚',
  profile: 'Î ÏÎ¿Ï†Î¯Î»',
  selectStore: 'Î•Ï€Î¹Î»Î­Î¾Ï„Îµ ÎšÎ±Ï„Î¬ÏƒÏ„Î·Î¼Î±',
  orderNow: 'Î Î±ÏÎ±Î³Î³ÎµÎ¯Î»Ï„Îµ Î¤ÏÏÎ±',
  // ... etc
};
```

### ğŸ” SECURITY CONSIDERATIONS

1. **JWT Storage:** Use secure storage (Keychain/Keystore)
2. **API Calls:** Always use HTTPS in production
3. **Input Validation:** Sanitize all user inputs
4. **Location:** Request permission before accessing
5. **Audio:** Request microphone permission

### ğŸ“± APP FLOW FOR MOBILE

```
1. Splash Screen
2. Check Auth Status
3. If not authenticated â†’ Login/Register
4. If authenticated â†’ Home (Store List)
5. Select Store â†’ New Order
6. Submit Order â†’ Order Status (Real-time tracking)
7. Bottom Navigation: Home | Orders | Profile
```

---

**CRITICAL NOTES FOR AI:**
1. The mobile app should mirror the web functionality exactly
2. Use the same API endpoints - no backend changes needed
3. Maintain the cyan (#00c2e8) color scheme throughout
4. All text must be in Greek (Î•Î»Î»Î·Î½Î¹ÎºÎ¬)
5. Focus on customer role only - no admin/store/driver features
6. Voice orders are optional - can be Phase 2
7. Start with core features: Login, Store List, Create Order, Track Order

This specification provides everything needed to recreate the customer portal as a React Native app. The AI should be able to use this as a complete blueprint.



npx expo start -c

eas login

eas build --platform android --profile preview

cd c:\Users\zisog\Documents\Projects\FastDelivery\fast-delivery-mobile\customer
eas build --platform android --profile preview